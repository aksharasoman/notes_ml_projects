---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data
## Text Elements
1. Semantic Similarity Search ^vWwRAmDF

vectordb.similarity_search(question,k=3) ^V5elm9Hd

2. Maximum Marginal Relevance (MMR) ^GnJC0pAX

vectordb.max_marginal_relevance_search(question,k=2,fetch_k=3) ^aCyzyISD

Relevant and Distinct Splits ^FDqvAq1M

Relevant Splits ^dxhmbCbl

3. Self Query Retriever ^m7zl671K

SelfQueryRetriever.from_llm(llm, vectordb, document_content_description,metadata_field_info)
<< check [help docs](https://python.langchain.com/v0.1/docs/modules/data_connection/retrievers/self_query/) or course ipynb ^6UrEd5oH

uses an LLM to filter
 based on metadata  ^xcyFtUVP

4. Compression ^whgy1kZr

compressor = LLMChainExtractor.from_llm(llm)
compression_retriever = ContextualCompressionRetriever(
    base_compressor=compressor,
    base_retriever=vectordb.as_retriever())
compressed_docs = compression_retriever.get_relevant_documents(qn) ^KkPi12UL

shrink doc splits:
 to highlight relevant info ^pmPA8oCu

%%
## Drawing
```compressed-json
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
```
%%